webpackJsonp([1],{"/dKF":function(t,e){},"7FVV":function(t,e){},"7bW9":function(t,e){},"90Dm":function(t,e){},"9lJl":function(t,e){},BBMS:function(t,e){},BgDq:function(t,e){},Bqo5:function(t,e){},D9hl:function(t,e){},Esmc:function(t,e){},Fs66:function(t,e){},FvRf:function(t,e){},"M/yy":function(t,e){},NCQU:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("7+uW"),i=n("mvHQ"),s=n.n(i),r=n("BO1k"),a=n.n(r),c=function(t,e){var n=void 0;if(!e)return null;var o=!0,i=!1,s=void 0;try{for(var r,c=a()(e);!(o=(r=c.next()).done);o=!0){var l=r.value;(void 0===n||l[t]<n)&&(n=l[t])}}catch(t){i=!0,s=t}finally{try{!o&&c.return&&c.return()}finally{if(i)throw s}}return n},l=null,u=function(t,e){localStorage.setItem("customDesk-"+t,e)},d=function(t){return localStorage.getItem("customDesk-"+t)};var h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{directives:[{name:"pick",rawName:"v-pick",value:"coustom",expression:"'coustom'"}],staticClass:"item"},[e("i",{staticClass:"icon-coustom"}),this._v("\n  自定义\n")])},staticRenderFns:[]};var m={name:"Aside",components:{coustom:n("VU/8")({name:"coustom",data:function(){return{msg:""}},methods:{back:function(){}}},h,!1,function(t){n("PSQn")},"data-v-18b3d1d8",null).exports},data:function(){return{folder:!1}}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"slide"}},[n("el-aside",{style:{marginLeft:t.folder?"-100px":"0"},attrs:{id:"aside",width:"100px"}},[n("div",{staticClass:"txt"},[t._v("侧边栏")]),t._v(" "),n("div",{staticClass:"btn-folder",class:{isfolder:t.folder},attrs:{title:t.folder?"展开":"收起"},on:{click:function(e){t.folder=!t.folder}}},[n("i",{staticClass:"el-icon-arrow-left"})]),t._v(" "),n("coustom")],1)],1)},staticRenderFns:[]};var f=n("VU/8")(m,v,!1,function(t){n("9lJl")},"data-v-38d08d7c",null).exports,p=n("Dd8w"),g=n.n(p),x=n("R4Sj"),w={name:"resolution",data:function(){return{resolutionList:["1920*1080","1680*1050","1440*900","2560*1440"],visible:!1,width:"",height:"",coustomVisible:!1}},mounted:function(){var t=this;setTimeout(function(){t.$editor.listenser.on({name:"mousedown",callback:function(){t.visible=!1,t.coustomVisible=!1}})},0)},computed:{noEdit:function(){return 1===this.storeState.editData.state},resolution:{get:function(){return this.storeState.resolution},set:function(t){this.changeResolution({resolution:t,resolutionIsCoustom:this.isCoustom,resolutionCoustom:this.resolutionCoustom})}},isCoustom:{get:function(){return this.storeState.resolutionIsCoustom},set:function(t){this.changeResolution({resolution:this.resolution,resolutionIsCoustom:t,resolutionCoustom:this.resolutionCoustom})}},resolutionCoustom:{get:function(){return this.storeState.resolutionCoustom},set:function(t){this.changeResolution({resolution:this.resolution,resolutionCoustom:t,resolutionIsCoustom:this.isCoustom})}}},methods:g()({},Object(x.b)(["changeResolution"]),{selectCoustom:function(){this.resolutionCoustom?(this.isCoustom=!0,this.resolution=this.resolutionCoustom,this.coustomVisible=!1,this.hideDropdown()):this.coustomVisible=!0},hideDropdown:function(){this.coustomVisible=!1,this.visible=!1},selectResolution:function(t){this.isCoustom=!1,this.resolution=t,this.hideDropdown()},coustomSave:function(){this.width&&this.height?this.width<1176||this.height<664||this.width>4098||this.height>2160?this.$message.error("请合理设置宽高！"):(this.resolution=this.width+"*"+this.height,this.resolutionCoustom=this.resolution,this.isCoustom=!0,this.hideDropdown()):this.$message.error("请设置宽高！")}})},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tb-item"},[t._v("\n  分辨率\n  "),n("div",{staticClass:"dropdown"},[t.noEdit?n("div",[n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"模板已经启用，不可修改分辨率",placement:"bottom"}},[n("span",{staticClass:"el-dropdown-link",on:{click:function(e){t.visible=!t.visible}}},[t._v("\n          "+t._s(t.resolution)),n("i",{staticClass:"el-icon-caret-bottom el-icon--right"})])])],1):n("span",{staticClass:"el-dropdown-link",on:{click:function(e){t.visible=!t.visible}}},[t._v("\n      "+t._s(t.resolution)),n("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible&&!t.noEdit,expression:"visible && !noEdit"}],staticClass:"dropdown-menu",on:{mousedown:function(t){t.stopPropagation()},click:function(t){t.stopPropagation()}}},[t._l(t.resolutionList,function(e,o){return n("div",{key:o,staticClass:"dropdown-item",on:{click:function(n){return t.selectResolution(e)}}},[t.resolution!==e||t.isCoustom?t._e():n("i",{staticClass:"el-icon-check"}),t._v(t._s(e)+"\n      ")])}),t._v(" "),n("div",{staticClass:"dropdown-item"},[t.isCoustom?n("i",{staticClass:"el-icon-check"}):t._e(),t._v(" "),n("div",{on:{click:t.selectCoustom}},[t._v(t._s(t.resolutionCoustom?t.resolutionCoustom:"自定义"))]),t._v(" "),t.resolutionCoustom?n("i",{staticClass:"el-icon-edit",on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.coustomVisible="show"}}}):t._e(),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.coustomVisible,expression:"coustomVisible"}],staticClass:"coustom"},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:6}},[n("el-input",{attrs:{placeholder:"宽度",type:"number"},model:{value:t.width,callback:function(e){t.width=e},expression:"width"}})],1),t._v(" "),n("el-col",{attrs:{span:1}},[t._v("*")]),t._v(" "),n("el-col",{attrs:{span:6}},[n("el-input",{attrs:{placeholder:"高度",type:"number"},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}})],1),t._v(" "),n("el-col",{attrs:{span:8}},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.coustomSave}},[t._v("确定")])],1)],1),t._v(" "),t._m(0)],1)])],2)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip"},[this._v("只能输入整数，单位为px"),e("br"),this._v("宽度：1176-4098，高度：664-2160")])}]};var k=n("VU/8")(w,y,!1,function(t){n("QG2y")},"data-v-f5b40040",null).exports,b=function(t){var e={Control:17,Left:37,Up:38,Right:39,Down:40,Delete:46,Enter:13,A:65,Z:90,Y:89,L:76,S:83,"[":219,"]":221};for(var n in e)e[n.toLowerCase()]=e[n];return e[t]},C={mounted:function(){var t=this;this.$nextTick(function(){t.$editor.listenser.on({name:"keydown",callback:function(e,n){t.keyCallback&&t.keyCallback(e,n)}})})},methods:{keymap:b}},_={name:"layout",mixins:[C],data:function(){return{msg:""}},computed:g()({},Object(x.c)(["hasRedo","hasUndo"])),methods:{keyCallback:function(t,e){e.ctrlKey&&(t===this.keymap("Z")?(this.undo(),e.preventDefault()):t===this.keymap("Y")&&(this.redo(),e.preventDefault()))},undo:function(){this.$store.history.undo()},redo:function(){this.$store.history.redo()}}},M={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tb-item"},[e("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"撤销(Ctrl+Z)",placement:"bottom"}},[e("div",{staticClass:"icon-undo",class:{disabled:!this.hasUndo},on:{click:this.undo}})]),this._v(" "),e("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"恢复(Ctrl+Y)",placement:"bottom"}},[e("div",{staticClass:"icon-redo",class:{disabled:!this.hasRedo},on:{click:this.redo}})])],1)},staticRenderFns:[]};var $=n("VU/8")(_,M,!1,function(t){n("Fs66")},"data-v-3d64b60e",null).exports,A={name:"updown",mixins:[C],computed:{disabled:function(){return 1!==this.activeUnlockModule().length}},methods:{keyCallback:function(t,e){e.ctrlKey&&(t===this.keymap("]")?(this.updown("up"),e.preventDefault()):t===this.keymap("[")&&(this.updown("down"),e.preventDefault()))},updown:function(t){this.$store.commit("updownComponent",t)}}},S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tb-item"},[n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"置于顶层(Ctrl+])",placement:"bottom"}},[n("div",{staticClass:"tb-up",class:{disabled:t.disabled},on:{click:function(e){return t.updown("up")}}})]),t._v(" "),n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"置于底层(Ctrl+[)",placement:"bottom"}},[n("div",{staticClass:"tb-down",class:{disabled:t.disabled},on:{click:function(e){return t.updown("down")}}})])],1)},staticRenderFns:[]};var E=n("VU/8")(A,S,!1,function(t){n("w8ly")},"data-v-190b2094",null).exports,N={name:"updown",computed:{active:function(){var t=this.activeModuleName;return!!(t&&Array.isArray(t)&&t.length>1)}},methods:{updown:function(t){this.$store.commit("updownComponent",t)},updatePos:function(t,e,n){var o={name:t};e&&(o.x=e),n&&(o.y=n),this.$store.commit("updatePos",o)},align:function(t){var e=this,n=this.activeUnlockModule(),o=void 0;switch(t){case"left":o=function(){var t=c("x",n);e.iteratorActiveModule(function(n,o){e.updatePos(o,t)})};break;case"center":o=function(){var t=void 0,n=void 0;e.iteratorActiveModule(function(e,o){var i=e.x+e.width;(!t||e.x<t)&&(t=e.x),(!n||i>n)&&(n=i)}),e.iteratorActiveModule(function(o,i){var s=t+(n-t)/2;e.updatePos(i,s-o.width/2)})};break;case"right":o=function(){var t=void 0;e.iteratorActiveModule(function(e,n){if(!e.locked){var o=e.x+e.width;(!t||o>t)&&(t=o)}}),e.iteratorActiveModule(function(n,o){e.updatePos(o,t-n.width)})};break;case"top":o=function(){var t=c("y",n);e.iteratorActiveModule(function(n,o){e.updatePos(o,null,t)})};break;case"middle":o=function(){var t=void 0,n=void 0;e.iteratorActiveModule(function(e,o){var i=e.y+e.height;(!t||e.y<t)&&(t=e.y),(!n||i>n)&&(n=i)}),e.iteratorActiveModule(function(o,i){var s=t+(n-t)/2;e.updatePos(i,null,s-o.height/2)})};break;case"bottom":o=function(){var t=void 0;e.iteratorActiveModule(function(e,n){var o=e.y+e.height;(!t||o>t)&&(t=o)}),e.iteratorActiveModule(function(n,o){var i=t-n.height;e.updatePos(o,null,i)})};break;case"vertical":o=function(){var t,n,o=e.activeUnlockModule(),i=o.length,s=0;i<3||(o.sort(function(t,e){return t.y>e.y}),t=o[0].y+o[0].height/2,n=(o[i-1].y+o[i-1].height/2-t)/(i-1),e.iteratorActiveModule(function(o,r){if(!o.locked){if(0!==s&&s!==i-1){var a=t+n*s-o.height/2;e.updatePos(r,null,a)}s++}}))};break;case"justify":o=function(){var t,n,o=e.activeUnlockModule(),i=o.length,s=0;i<3||(o.sort(function(t,e){return t.x>e.x}),t=o[0].x+o[0].width/2,n=(o[i-1].x+o[i-1].width/2-t)/(i-1),e.iteratorActiveModule(function(o,r){if(!o.locked){if(0!==s&&s!==i-1){var a=t+n*s-o.width/2;e.updatePos(r,a)}s++}}))}}o()}}},T={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tb-item"},[t.active?[n("el-dropdown",{attrs:{trigger:"click",placement:"bottom-start"},on:{command:t.align}},[n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"对齐",placement:"bottom"}},[n("span",{staticClass:"tb-align"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"left"}},[n("i",{staticClass:"icon-align icon-align-left"}),t._v("\n          左对齐\n        ")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"center"}},[n("i",{staticClass:"icon-align icon-align-center"}),t._v("\n          左右居中\n        ")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"right"}},[n("i",{staticClass:"icon-align icon-align-right"}),t._v("\n          右对齐\n        ")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"top",divided:""}},[n("i",{staticClass:"icon-align icon-align-top"}),t._v("\n          顶部对齐\n        ")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"middle"}},[n("i",{staticClass:"icon-align icon-align-middle"}),t._v("\n          上下居中\n        ")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"bottom"}},[n("i",{staticClass:"icon-align icon-align-bottom"}),t._v("\n          底部对齐\n        ")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"justify",divided:""}},[n("i",{staticClass:"icon-align icon-align-justify"}),t._v("\n          水平分布\n        ")]),t._v(" "),n("el-dropdown-item",{attrs:{command:"vertical"}},[n("i",{staticClass:"icon-align icon-align-vertical"}),t._v("\n          垂直分布\n        ")])],1)],1)]:[n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"对齐",placement:"bottom"}},[n("span",{staticClass:"tb-align disabled"})])]],2)},staticRenderFns:[]};var I=n("VU/8")(N,T,!1,function(t){n("jZJS")},"data-v-9c763024",null).exports,L={name:"lock",mixins:[C],data:function(){return{msg:""}},computed:{disabledLock:function(){return 1!==this.activeUnlockModule().length},disabledUnlock:function(){return this.iteratorActiveModule().length-this.activeUnlockModule().length!=1}},methods:{keyCallback:function(t,e){e.ctrlKey&&t===this.keymap("L")&&(e.shiftKey?this.lock("unlock"):this.lock("lock"),e.preventDefault())},lock:function(t){this.disabledLock&&"lock"===t||this.disabledUnlock&&"unlock"===t||this.activeModuleName&&this.$store.commit("lock",t)}}},U={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tb-item"},[n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"锁定(Ctrl+L)",placement:"bottom"}},[n("div",{staticClass:"tb-lock",class:{disabled:t.disabledLock},on:{click:function(e){return t.lock("lock")}}})]),t._v(" "),n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"解锁(Ctrl+Shift+L)",placement:"bottom"}},[t._v("\n  disabledUnlock () {\n    "),n("div",{staticClass:"tb-unlock",class:{disabled:t.disabledUnlock},on:{click:function(e){return t.lock("unlock")}}})])],1)},staticRenderFns:[]};var P=n("VU/8")(L,U,!1,function(t){n("hlQI")},"data-v-91b924b4",null).exports,R={name:"size",data:function(){return{}},computed:{width:{get:function(){return this.getSingleActiveModule("width")||""},set:function(t){t<80||!1===this.getSingleActiveModule("locked")&&this.updateSize({name:name,width:t})}},height:{get:function(){return this.getSingleActiveModule("height")||""},set:function(t){t<100||!1===this.getSingleActiveModule("locked")&&this.updateSize({name:name,height:t})}}},methods:g()({},Object(x.b)(["updateSize"]),{keydownHandler:function(t){var e=this[t];event.keyCode===b("Up")?e++:event.keyCode===b("Down")&&e--,this[t]=e,event.stopPropagation()}})},F={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tb-item"},[n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"宽",placement:"bottom"}},[n("div",{staticClass:"width"},[t._v("\n      宽："),n("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.width,expression:"width",modifiers:{lazy:!0}}],staticClass:"inp",attrs:{type:"text"},domProps:{value:t.width},on:{keydown:function(e){return e.stopPropagation(),t.keydownHandler("width")},change:function(e){t.width=e.target.value}}})])]),t._v(" "),n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"高",placement:"bottom"}},[n("div",[t._v("\n      高："),n("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.height,expression:"height",modifiers:{lazy:!0}}],staticClass:"inp",attrs:{type:"text"},domProps:{value:t.height},on:{keydown:function(e){return e.stopPropagation(),t.keydownHandler("height")},change:function(e){t.height=e.target.value}}})])])],1)},staticRenderFns:[]};var V=n("VU/8")(R,F,!1,function(t){n("eQ82")},"data-v-2bd38dd6",null).exports,D={name:"size",mixins:[C],data:function(){return{}},computed:{x:{get:function(){var t=void 0;return this.iteratorActiveModule(function(e){t=e.x},function(){t=""}),t},set:function(t){var e=this;this.iteratorActiveModule(function(n,o){n.locked||e.$store.commit("updatePos",{name:o,x:t})})}},y:{get:function(){var t=void 0;return this.iteratorActiveModule(function(e){t=e.y},function(){t=""}),t},set:function(t){var e=this;this.iteratorActiveModule(function(n,o){n.locked||e.$store.commit("updatePos",{name:o,y:t})})}}},methods:{keyCallback:function(t,e){e.ctrlKey||(t===this.keymap("Up")?(this.y=this.y-1,e.preventDefault()):t===this.keymap("Down")?(this.y=this.y+1,e.preventDefault()):t===this.keymap("Left")?(this.x=this.x-1,e.preventDefault()):t===this.keymap("Right")&&(this.x=this.x+1,e.preventDefault()),this.x=this.x<0?0:this.x,this.y=this.y<0?0:this.y)},keydownHandlerX:function(){event.keyCode===b("Up")?this.x=this.x+1:event.keyCode===b("Down")&&(this.x=this.x-1),this.x=this.x<0?0:this.x,event.stopPropagation()},keydownHandlerY:function(){event.keyCode===b("Up")?this.y=this.y+1:event.keyCode===b("Down")&&(this.y=this.y-1),this.y=this.y<0?0:this.y,event.stopPropagation()}}},z={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tb-item"},[n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"横向",placement:"bottom"}},[n("div",[t._v("\n      x："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.x,expression:"x"}],staticClass:"inp",attrs:{type:"text"},domProps:{value:t.x},on:{keydown:function(e){return e.stopPropagation(),t.keydownHandlerX(e)},input:function(e){e.target.composing||(t.x=e.target.value)}}})])]),t._v(" "),n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"纵向",placement:"bottom"}},[n("div",[t._v("\n      y："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.y,expression:"y"}],staticClass:"inp",attrs:{type:"text"},domProps:{value:t.y},on:{keydown:function(e){return e.stopPropagation(),t.keydownHandlerY(e)},input:function(e){e.target.composing||(t.y=e.target.value)}}})])])],1)},staticRenderFns:[]};var B=n("VU/8")(D,z,!1,function(t){n("aAE9")},"data-v-1dc0f812",null).exports,O={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tb-item"},[n("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"中轴线",placement:"bottom"}},[n("el-checkbox-group",{attrs:{size:"mini"},model:{value:t.showAxis,callback:function(e){t.showAxis=e},expression:"showAxis"}},[n("el-checkbox",{attrs:{label:"显示中轴线"}})],1)],1)],1)},staticRenderFns:[]};var H=n("VU/8")({name:"axis",data:function(){return{}},computed:{showAxis:{get:function(){return this.storeState.showAxis},set:function(t){this.$store.commit("toggleAxis",t)}}}},O,!1,function(t){n("M/yy")},"data-v-072d39a0",null).exports,X={name:"fullscreen",data:function(){return{isFullscreen:!1}},mounted:function(){var t=this;this.$nextTick(function(){t.$editor.listenser.on({name:"exitFullScreen",callback:function(){t.isFullscreen=!1}}),t.$editor.listenser.on({name:"entryfullScreen",callback:function(){t.isFullscreen=!0}})})},methods:{toggleFullscreen:function(){var t=document.webkitIsFullScreen,e=document.getElementsByTagName("body")[0];t?(document.webkitExitFullscreen(),this.isFullscreen=!1):(e.webkitRequestFullScreen(),this.isFullscreen=!0)}}},Y={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tb-item",on:{click:this.toggleFullscreen}},[e("i",{staticClass:"icon-fullscreen"}),this._v("\n  "+this._s(this.isFullscreen?"退出全屏":"全屏")+"\n")])},staticRenderFns:[]};var j,q=n("VU/8")(X,Y,!1,function(t){n("anDC")},"data-v-5b49cc7b",null).exports,W=n("Xxa5"),G=n.n(W),Q=n("exGp"),J=n.n(Q),K=n("pFYg"),Z=n.n(K),tt=n("//Fk"),et=n.n(tt),nt=n("fZjL"),ot=n.n(nt),it=n("rG/O"),st=n.n(it),rt=function(){var t,e,n=(t=document.createElement("canvas"),{canvas:!!(e=t.getContext("2d")),imageData:!!e.getImageData,dataURL:!!t.toDataURL,btoa:!!window.btoa});function o(t,e,n){var o=t.width,i=t.height;void 0==e&&(e=o),void 0==n&&(n=i);var s=document.createElement("canvas"),r=s.getContext("2d");return s.width=e,s.height=n,r.drawImage(t,0,0,o,i,0,0,e,n),s}function i(t,e,n,i){return(t=o(t,n,i)).toDataURL(e)}function s(t){document.location.href=t}function r(t){var e=document.createElement("img");return e.src=t,e}function a(t){return"image/"+(t=t.toLowerCase().replace(/jpg/i,"jpeg")).match(/png|jpeg|bmp|gif/)[0]}function c(t){if(!window.btoa)throw"btoa undefined";var e="";if("string"==typeof t)e=t;else for(var n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function l(t){var e=t.width,n=t.height;return t.getContext("2d").getImageData(0,0,e,n)}function u(t,e){return"data:"+e+";base64,"+t}var d=function(t){var e=t.width,n=t.height,o=e*n*3,i=o+54,s=[66,77,255&i,i>>8&255,i>>16&255,i>>24&255,0,0,0,0,54,0,0,0],r=[40,0,0,0,255&e,e>>8&255,e>>16&255,e>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,1,0,24,0,0,0,0,0,255&o,o>>8&255,o>>16&255,o>>24&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a=(4-3*e%4)%4,l=t.data,u="",d=e<<2,h=n,m=String.fromCharCode;do{for(var v=d*(h-1),f="",p=0;p<e;p++){var g=p<<2;f+=m(l[v+g+2])+m(l[v+g+1])+m(l[v+g])}for(var x=0;x<a;x++)f+=String.fromCharCode(0);u+=f}while(--h);return c(s.concat(r))+c(u)},h=function(t,e,r,c){if(n.canvas&&n.dataURL)if("string"==typeof t&&(t=document.getElementById(t)),void 0==c&&(c="png"),c=a(c),/bmp/.test(c)){var h=l(o(t,e,r));s(u(d(h),"image/octet-stream"))}else{s(i(t,c,e,r).replace(c,"image/octet-stream"))}},m=function(t,e,s,c){if(n.canvas&&n.dataURL){if("string"==typeof t&&(t=document.getElementById(t)),void 0==c&&(c="png"),c=a(c),/bmp/.test(c)){var h=l(o(t,e,s));return r(u(d(h),"image/bmp"))}return r(i(t,c,e,s))}};return{saveAsImage:h,saveAsPNG:function(t,e,n){return h(t,e,n,"png")},saveAsJPEG:function(t,e,n){return h(t,e,n,"jpeg")},saveAsGIF:function(t,e,n){return h(t,e,n,"gif")},saveAsBMP:function(t,e,n){return h(t,e,n,"bmp")},convertToImage:m,convertToPNG:function(t,e,n){return m(t,e,n,"png")},convertToJPEG:function(t,e,n){return m(t,e,n,"jpeg")},convertToGIF:function(t,e,n){return m(t,e,n,"gif")},convertToBMP:function(t,e,n){return m(t,e,n,"bmp")}}}(),at={name:"updown",mixins:[C],data:function(){return{}},mounted:function(){var t=this;setTimeout(function(){t.$editor.listenser.on({name:"handleSave",callback:t.handleSave})},0)},methods:{isModify:function(){return d("lastModify")!==s()(this.$store.history.getCurdo())},keyCallback:function(t,e){e.ctrlKey&&t===this.keymap("S")&&(this.handleSave(),e.preventDefault())},saveLcok:function(){var t=this;return clearTimeout(this.saveLockTimer),this.saveLockTimer=setTimeout(function(){t.saveLock=!1},1e3),!!this.saveLock||(this.saveLock=!0,!1)},checkDownload:function(){var t=this;if(this.isModify()){var e=ot()(this.storeState);return e.length&&-1===e.indexOf("module-downloadArea")&&!1===this.storeState.deskIconsVisbile?this.$confirm("建议您添加【下载区】，无下载区会导致顾客无法在桌面创建或保存文件，影响顾客上网体验","提示",{type:"error",confirmButtonText:"仍然保存",cancelButtonText:"立即添加",cancelButtonClass:"btn-save-cancel",confirmButtonClass:"btn-save-confirm"}).catch(function(e){return t.$store.commit("showBubbleTip",{type:"downloadArea",visible:!0}),et.a.reject(new Error)}):et.a.resolve()}return et.a.resolve()},checkOrigin:function(){var t=this;if(this.isModify()){var e=ot()(this.storeState);return e.length&&e.indexOf("module-origin")>=0&&!0===this.storeState.deskIconsVisbile?this.$confirm("建议您将【客户机桌面图标隐藏】，因您添加了【原图标】，桌面会出现两套原桌面图标，可能影响顾客上网体验","提示",{type:"error",confirmButtonText:"仍然保存",cancelButtonText:"立即隐藏",cancelButtonClass:"btn-save-cancel",confirmButtonClass:"btn-save-confirm"}).catch(function(e){return t.$store.commit("showBubbleTip",{type:"origin",visible:!0}),et.a.reject(new Error)}):et.a.resolve()}return et.a.resolve()},addModuleName:function(){return this.$globalData.editId?et.a.resolve():this.$prompt("请输入模板名称","提示",{confirmButtonText:"保存",cancelButtonText:"取消",inputValidator:function(t){return!(!t||t.length>20)},inputErrorMessage:"请输入不超过20个字符长度名称"})},continueEdit:function(){var t=this;this.$confirm("保存成功","提示",{type:"success",confirmButtonText:"继续编辑",cancelButtonText:"退出编辑"}).catch(function(e){t.$editor.listenser.fire("exit")})},previewImg:function(t){var e=this;j=this.$loading({lock:!0,text:"正在保存自定义桌面...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, .9)"});var n,o=document.getElementById("main"),i="";try{(n=document.querySelector(".el-main")).scrollTop=0,n.scrollLeft=0,i=o.style.backgroundImage,o.style.position="absolute",o.style.top=0,o.style.left=0,o.style.backgroundImage="none",st()(o,{useCORS:!1,logging:!1,imageTimeout:0,backgroundColor:null,ignoreElements:function(t){return"task-area"===t.class}}).then(function(n){var s=rt.convertToPNG(n,390,220);e.save(t,s.src),o.style.position="",o.style.backgroundImage=i})}catch(e){this.save(t),o.style.position="",o.style.backgroundImage=i}},formatLayout:function(t){var e=this.deepClone(t);return delete e.coustomIconsEdit,delete e.editData,delete e.originForbidVisible,delete e.skinVisible,delete e.dialogWallVisible,e},save:function(t,e){var n=this,o=[];this.iteratorModule(function(t,e){o.push(g()({},t,{name:e}))});var i="";this.storeState.wall&&this.storeState.openWall&&(Array.isArray(this.storeState.wall)?i=this.storeState.wall.map(function(t){return{_id:t._id}}):"object"===Z()(this.storeState.wall)&&(this.storeState.wall=[this.storeState.wall]));var r=this.formatLayout(this.storeState),a={resolution:this.storeState.resolution,name:t||"",preview:e,layout:r,html:"",wallpaper:i,desktop_mask_visible:!r.deskIconsVisbile,random_wallpaper:this.storeState.randomWall};this.$globalData.editId&&(a._id=this.$globalData.editId,delete a.name),this.$http.post("/dpp/api/v1/custom-desktop/template/save",a).then(function(t){u("lastModify",s()(n.$store.history.getCurdo())),n.$globalData.editId=t.data._id,n.continueEdit()}),j.close()},handleSave:function(){var t=this;return J()(G.a.mark(function e(){var n;return G.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.saveLcok()){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,t.checkDownload();case 5:return e.next=7,t.checkOrigin();case 7:return e.next=9,t.addModuleName();case 9:(n=e.sent)?t.previewImg(n.value):t.previewImg(),e.next=15;break;case 13:e.prev=13,e.t0=e.catch(2);case 15:case"end":return e.stop()}},e,t,[[2,13]])}))()}}},ct={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tb-item",attrs:{id:"header-icon-save"},on:{click:this.handleSave}},[e("el-tooltip",{staticClass:"tooltip-item",attrs:{effect:"dark",content:"保存(Ctrl+S)",placement:"bottom"}},[e("i",{staticClass:"icon-save"})]),this._v("保存\n")],1)},staticRenderFns:[]};var lt={name:"exit",mounted:function(){var t=this;setTimeout(function(){t.$editor.listenser.on({name:"exit",callback:t.exit})},0)},methods:{handleExit:function(){var t=this;d("lastModify")!==s()(this.$store.history.getCurdo())?this.$confirm("当前操作还未保存，直接关闭将会丢失所有修改","提示",{type:"error",confirmButtonText:"保存修改",cancelButtonText:"直接退出"}).then(function(){t.$editor.listenser.fire("handleSave")}).catch(function(e){t.exit()}):this.exit()},exit:function(){window.opener&&(window.opener.location.reload(),window.opener=null),window.close()}}},ut={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tb-item",on:{click:this.handleExit}},[e("i",{staticClass:"icon-exit"}),this._v("退出\n")])},staticRenderFns:[]};var dt={name:"Aside",components:{resolution:k,reundo:$,updown:E,align:I,lock:P,size:V,position:B,menuAxis:H,fullscreen:q,save:n("VU/8")(at,ct,!1,function(t){n("jF/t"),n("Bqo5")},"data-v-3ae70856",null).exports,exit:n("VU/8")(lt,ut,!1,function(t){n("Esmc")},"data-v-60a7156e",null).exports}},ht={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-header",[n("span",{staticClass:"title"},[t._v("VEditor")]),t._v(" "),n("resolution"),t._v(" "),n("reundo"),t._v(" "),n("updown"),t._v(" "),n("align"),t._v(" "),n("lock"),t._v(" "),n("size"),t._v(" "),n("position"),t._v(" "),n("menu-axis"),t._v(" "),n("exit"),t._v(" "),n("save"),t._v(" "),n("fullscreen")],1)},staticRenderFns:[]};var mt=n("VU/8")(dt,ht,!1,function(t){n("BgDq")},"data-v-43f6f839",null).exports,vt=n("woOf"),ft=n.n(vt),pt=n("OvRC"),gt=n.n(pt),xt=void 0,wt=gt()(null,{}),yt=[],kt=[],bt=function(t){return JSON.parse(s()(t))},Ct=function(){return!!yt.length},_t=function(){return!!kt.length},Mt=function(){xt.commit("refreshHistoryBtn",{hasUndo:Ct(),hasRedo:_t()})},$t=function(){var t;s()(xt.state)!==s()(wt)&&(t=wt,ot()(t).length&&yt.push(wt),wt=bt(xt.state),kt=[],Mt())},At=function(){Ct()&&(kt.unshift(wt),wt=yt.pop(),xt.commit("updateHistory",bt(wt)),Mt())},St=function(){_t()&&(yt.push(wt),wt=kt.shift(),xt.commit("updateHistory",bt(wt)),Mt())},Et=function(){return wt},Nt=function(t){return xt=t,{update:$t,undo:At,redo:St,getCurdo:Et}},Tt={Resolution:{state:{resolution:"1920*1080",resolutionIsCoustom:!1,resolutionCoustom:""},mutations:{changeResolution:function(t,e){t.resolution=e.resolution,t.resolutionIsCoustom=e.resolutionIsCoustom,t.resolutionCoustom=e.resolutionCoustom}}},Axis:{state:{showAxis:!1},mutations:{toggleAxis:function(t,e){t.showAxis=e}}},Crossline:{state:{crossline:{x:-1,y:-1}},mutations:{updateCrossline:function(t,e){void 0!==e.x&&(t.crossline.x=e.x),void 0!==e.y&&(t.crossline.y=e.y)}}},Contextmenu:{state:{contextmenu:{show:!1,x:0,y:0,componentName:""}},mutations:{visibleContextmenu:function(t,e){for(var n in e)t.contextmenu[n]=e[n]}}},Unredo:{state:{hasUndo:!1,hasRedo:!1},mutations:{updateHistory:function(t,e){if(e){for(var n in function t(e,n){if(e)for(var i in n)"object"===Z()(n[i])&&null!==n[i]?(o.default.set(e,i,n[i]instanceof Array?[]:{}),t(e[i],n[i])):o.default.set(e,i,n[i])}(t,e),t)void 0===e[n]&&o.default.delete(t,n)}},refreshHistoryBtn:function(t,e){t.hasUndo=e.hasUndo,t.hasRedo=e.hasRedo}}},textEditor:{state:{textEditorVisible:!1},mutations:{toggleEditorVisible:function(t,e){t.textEditorVisible=e}}},Sidebar:{state:{showSidebar:!0},mutations:{toggleSidebar:function(t,e){t.showSidebar=e}}}},It=function(t){return 0===t.indexOf("module-")},Lt=function(t,e){var n=[];for(var o in t){var i=t[o];It(o)&&(n.push(i),e&&e(i,o))}return n},Ut=function(t,e,n){var o=[],i=t.activeModule;if(i)if(Array.isArray(i)){var s=!0,r=!1,c=void 0;try{for(var l,u=a()(i);!(s=(l=u.next()).done);s=!0){var d=l.value;e&&e(t[d],d),o.push(t[d])}}catch(t){r=!0,c=t}finally{try{!s&&u.return&&u.return()}finally{if(r)throw c}}}else e&&e(t[i],i),o.push(t[i]);else n&&n();return o},Pt=function(t){var e=Ut(t);return e.length&&(e=e.filter(function(t){return!t.locked})),e},Rt=function(t,e){var n=t.activeModule;return!n||Array.isArray(n)?null:e?t[n][e]:t[n]},Ft=It,Vt=Ut;o.default.use(x.a);var Dt=function(t,e){var n={};for(var o in e)for(var i in e[o])i===t&&ft()(n,e[o][i]);return n},zt=new x.a.Store({state:ft()(Dt("state",Tt),{activeModule:null,selectArea:{show:!1,x:0,y:0,rx:0,by:0},editData:""}),mutations:ft()(Dt("mutations",Tt),{updateSize:function(t,e){var n=e.name||t.activeModule;void 0!==e.width&&(t[n].width=e.width),void 0!==e.height&&(t[n].height=e.height)},updatePos:function(t,e){var n=e.name||t.activeModule;void 0!==e.x&&(t[n].x=e.x),void 0!==e.y&&(t[n].y=e.y)},lock:function(t,e){Vt(t,"lock"===e?function(t,e){!1===t.locked&&(t.locked=!0)}:function(t,e){!0===t.locked&&(t.locked=!1)})},updownComponent:function(t,e){var n=1,o=t[t.activeModule],i=function(t){var e=t.activeModule,n=t[e].zIndex;for(var o in t)if(Ft(o)&&o!==e&&n===t[o].zIndex)return!0;return!1}(t);for(var s in t)if(Ft(s)){var r=t[s];"up"===e?r.zIndex>o.zIndex&&(i||r.zIndex--,r.zIndex>n&&(n=r.zIndex)):"down"===e&&(i||r.zIndex<o.zIndex)&&r.zIndex++}o.zIndex="up"===e?n+1:1},activeModule:function(t,e){t.activeModule=e}}),modules:{}});zt.history=Nt(zt,o.default);var Bt=zt,Ot={coustom:function(t){var e={active:!1,txt:99,moveX:0,moveY:0,x:-332,y:-328,width:332,height:328,zIndex:1,locked:!1,skin:0,textEditorContent:""};return ft()(e,t),{namespaced:!0,state:e,mutations:{saveTextEditor:function(t,e){t.textEditorContent=e}}}}},Ht=function(){},Xt=window.location.href,Yt=-1!==Xt.indexOf("localhost")||-1!==Xt.indexOf("10."),jt="undefined"!=typeof console;Yt&&jt&&(Ht=function(t){console.error("[warn]："+t)});var qt=function(t,e){if(Ot[t]){var n=function(t){var e="module-"+t,n="";for(var o in Bt.state)if(0===o.indexOf(e)){var i=o.split(e+"-")[1];i?(""===n||n<=i)&&(n=Number(i)+1):n=1}return n&&(e=e+"-"+n),e}(t);return Bt.registerModule(n,Ot[t](e)),n}Ht("没找到对应的组件！")},Wt=function(t){var e=Bt.state.activeModule;if(t)if(Bt.unregisterModule(t),Array.isArray(e)){var n=ft()([],e);n.splice(n.indexOf(t),1),Bt.commit("activeModule",n)}else e===t&&Bt.commit("activeModule",null);else if(e)if(Bt.commit("activeModule",null),Array.isArray(e)){var o=!0,i=!1,s=void 0;try{for(var r,c=a()(e);!(o=(r=c.next()).done);o=!0){var l=r.value;Bt.unregisterModule(l)}}catch(t){i=!0,s=t}finally{try{!o&&c.return&&c.return()}finally{if(i)throw s}}}else Bt.unregisterModule(e)},Gt={name:"compmenu",props:["menuItems"],data:function(){return{}},methods:{hasItem:function(t){return!this.menuItems||this.menuItems.split("|").indexOf(t)>=0},del:function(){Wt()}}},Qt={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"component-contextmenu"},[e("div",{directives:[{name:"show",rawName:"v-show",value:this.hasItem("del"),expression:"hasItem('del')"}],staticClass:"icon-del",attrs:{title:"删除"},on:{click:this.del}})])},staticRenderFns:[]};var Jt=n("VU/8")(Gt,Qt,!1,function(t){n("7bW9")},"data-v-5b938f96",null).exports,Kt={data:function(){return{}},computed:{stretchType:function(){if("module-coustom"===this.activeModuleName||"module-origin"===this.activeModuleName){var t=this.getSingleActiveModule("skin");if(2===t)return"hsd";if(7===t||8===t)return"vert"}return"all"},selectedComps:function(){var t=[],e=[],n=[];if(this.activeModuleName){if(this.iteratorActiveModule(function(t){t.locked?e.push(t):n.push(t)}),n.length>1){for(var o=c("x",n),i=c("y",n),s=void 0,r=void 0,l=0;l<n.length;l++){var u=n[l];(void 0===s||u.x+u.width>s)&&(s=u.x+u.width),(void 0===r||u.y+u.height>r)&&(r=u.y+u.height)}t.push({locked:!1,multiSelect:!0,left:o,top:i,width:s-o,height:r-i})}else 1===n.length&&t.push({locked:!1,left:n[0].x,top:n[0].y,width:n[0].width,height:n[0].height});if(e.length){var d=!0,h=!1,m=void 0;try{for(var v,f=a()(e);!(d=(v=f.next()).done);d=!0){var p=v.value;t.push({locked:!0,left:p.x,top:p.y,width:p.width,height:p.height})}}catch(t){h=!0,m=t}finally{try{!d&&f.return&&f.return()}finally{if(h)throw m}}}return t}}},methods:{getStyles:function(t){var e={top:t.top+"px",left:t.left+"px"};return!t.locked&&t.multiSelect&&(e.width=t.width+"px",e.height=t.height+"px"),e},resize:function(t,e){var n=this,o=ft()({},e);if(!o.multiSelect&&!o.locked){var i=this.$editor.listenser,s=event.pageX-this.$editor.containerOffset.x,r=event.pageY-this.$editor.containerOffset.y,a=o.width,c=o.height;i.on({name:"mousemove.resize",callback:function(e){var i=e.moveX-s,l=e.moveY-r;"top"===t?(o.left=e.moveX,o.top=e.moveY,o.width=a-i,o.height=c-l):"right"===t?(o.height>0&&(o.top=e.moveY),o.width=a+i,o.height=c-l):"bottom"===t?(o.width=a+i,o.height=c+l):"left"===t?(o.left=e.moveX,o.width=a-i,o.height=c+l):"vertLeft"===t?(o.left=e.moveX,o.width=a-i):"vertRight"===t?o.width=a+i:"hsdTop"===t?(o.top=e.moveY,o.height=c-l):"hsdBottom"===t&&(o.height=c+l),o.width<80&&(o.width=80),o.height<100&&(o.height=100),n.updateResize(o)}}),i.once({name:"mouseup.resize",callback:function(t){n.$store.history.update(),i.remove("mousemove.resize")}})}},updateResize:function(t){var e=this,n=function(n){e.$store.commit("updateSize",{name:n,width:t.width,height:t.height}),e.$store.commit("updatePos",{name:n,x:t.left,y:t.top})};this.iteratorActiveModule(function(t){t.locked||n(name)})}}},Zt={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.selectedComps,function(e,o){return n("div",{directives:[{name:"drag",rawName:"v-drag.stop",modifiers:{stop:!0}}],key:o,staticClass:"outer",class:{"outer-locked":e.locked},style:t.getStyles(e)},[n("div",{staticClass:"multiple-layer"}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"all"===t.stretchType,expression:"stretchType === 'all'"}],staticClass:"top",class:{"el-icon-close":e.locked},style:{top:"-6px",left:"-6px"},on:{mousedown:function(n){return n.stopPropagation(),t.resize("top",e)}}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"all"===t.stretchType,expression:"stretchType === 'all'"}],staticClass:"right",class:{"el-icon-close":e.locked},style:{top:"-6px",left:e.width+"px"},on:{mousedown:function(n){return n.stopPropagation(),t.resize("right",e)}}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"all"===t.stretchType,expression:"stretchType === 'all'"}],staticClass:"bottom",class:{"el-icon-close":e.locked},style:{top:e.height+"px",left:e.width+"px"},on:{mousedown:function(n){return n.stopPropagation(),t.resize("bottom",e)}}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"all"===t.stretchType,expression:"stretchType === 'all'"}],staticClass:"left",class:{"el-icon-close":e.locked},style:{top:e.height+"px",left:"-6px"},on:{mousedown:function(n){return n.stopPropagation(),t.resize("left",e)}}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"hsd"!==t.stretchType,expression:"stretchType !== 'hsd'"}],staticClass:"vert-left",class:{"el-icon-close":e.locked},style:{top:e.height/2-3+"px",left:"-6px"},on:{mousedown:function(n){return n.stopPropagation(),t.resize("vertLeft",e)}}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"hsd"!==t.stretchType,expression:"stretchType !== 'hsd'"}],staticClass:"vert-right",class:{"el-icon-close":e.locked},style:{top:e.height/2-3+"px",left:e.width+"px"},on:{mousedown:function(n){return n.stopPropagation(),t.resize("vertRight",e)}}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"vert"!==t.stretchType,expression:"stretchType !== 'vert'"}],staticClass:"hsd-top",class:{"el-icon-close":e.locked},style:{top:"-6px",left:e.width/2-3+"px"},on:{mousedown:function(n){return n.stopPropagation(),t.resize("hsdTop",e)}}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"vert"!==t.stretchType,expression:"stretchType !== 'vert'"}],staticClass:"hsd-bottom",class:{"el-icon-close":e.locked},style:{top:e.height+"px",left:e.width/2-3+"px"},on:{mousedown:function(n){return n.stopPropagation(),t.resize("hsdBottom",e)}}})])}),0)},staticRenderFns:[]};var te=n("VU/8")(Kt,Zt,!1,function(t){n("FvRf")},"data-v-cda1cd44",null).exports,ee={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{directives:[{name:"show",rawName:"v-show",value:this.crossline.x,expression:"crossline.x"}],staticClass:"hsd",style:{top:this.crossline.x+"px"}}),this._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:this.crossline.y,expression:"crossline.y"}],staticClass:"vert",style:{left:this.crossline.y+"px"}})])},staticRenderFns:[]};var ne=n("VU/8")({name:"crossline",data:function(){return{}},computed:{crossline:function(){return this.storeState.crossline}}},ee,!1,function(t){n("BBMS")},"data-v-9e576470",null).exports,oe={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{directives:[{name:"show",rawName:"v-show",value:this.showAxis,expression:"showAxis"}]},[e("div",{staticClass:"axis-hsd"}),this._v(" "),e("div",{staticClass:"axis-vert"})])},staticRenderFns:[]};var ie=n("VU/8")({name:"axis",computed:{showAxis:function(){return this.storeState.showAxis}}},oe,!1,function(t){n("UqU4")},"data-v-d6b2b2ca",null).exports,se={name:"axis",data:function(){return{}},computed:{contextmenu:function(){return this.storeState.contextmenu},locked:function(){var t=this.contextmenu.componentName;return!(!t||!this.storeState[t])&&this.storeState[t].locked}},mounted:function(){var t=this;this.$nextTick(function(){t.$editor.listenser.on({name:"keydown",callback:function(e,n){n.ctrlKey&&e===b("A")&&t.selectAll()}})})},methods:{hide:function(){this.$store.commit("visibleContextmenu",{show:!1})},up:function(){this.$store.commit("updownComponent","up"),this.hide()},down:function(){this.$store.commit("updownComponent","down"),this.hide()},lock:function(){this.getSingleActiveModule()&&this.$store.commit("lock","lock"),this.hide()},unlock:function(){this.getSingleActiveModule()&&this.$store.commit("lock","unlock"),this.hide()},del:function(){Wt(this.activeModuleName),this.hide()},selectAll:function(){var t=[];this.iteratorModule(function(e,n){t.push(n)}),t.length>1?this.$store.commit("activeModule",t):1===t.length&&this.$store.commit("activeModule",t[0]),this.hide()},setWALL:function(){this.$store.commit("visibleDialogWall",!0),this.hide()}}},re={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.contextmenu.show,expression:"contextmenu.show"}],staticClass:"contextmenu",style:{top:t.contextmenu.y+"px",left:t.contextmenu.x+"px"}},[n("ul",[n("li",{directives:[{name:"show",rawName:"v-show",value:t.contextmenu.componentName&&!t.locked,expression:"contextmenu.componentName && !locked"}],on:{mousedown:function(e){return e.stopPropagation(),t.up(e)}}},[t._v("置于顶层")]),t._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:t.contextmenu.componentName&&!t.locked,expression:"contextmenu.componentName && !locked"}],on:{mousedown:function(e){return e.stopPropagation(),t.down(e)}}},[t._v("置于底层")]),t._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:t.contextmenu.componentName&&!t.locked,expression:"contextmenu.componentName && !locked"}],on:{mousedown:function(e){return e.stopPropagation(),t.lock(e)}}},[t._v("锁定")]),t._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:t.contextmenu.componentName&&t.locked,expression:"contextmenu.componentName && locked"}],on:{mousedown:function(e){return e.stopPropagation(),t.unlock(e)}}},[t._v("解锁")]),t._v(" "),n("li",{directives:[{name:"show",rawName:"v-show",value:t.contextmenu.componentName,expression:"contextmenu.componentName"}],on:{mousedown:function(e){return e.stopPropagation(),t.del(e)}}},[t._v("删除")]),t._v(" "),n("li",{on:{mousedown:function(e){return e.stopPropagation(),t.selectAll(e)}}},[t._v("全选")])])])},staticRenderFns:[]};var ae=n("VU/8")(se,re,!1,function(t){n("U0M3")},"data-v-37544c11",null).exports,ce={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{directives:[{name:"show",rawName:"v-show",value:t.selectArea.show,expression:"selectArea.show"}],staticClass:"selectArea",style:{top:(t.selectArea.y<t.selectArea.by?t.selectArea.y:t.selectArea.by)+"px",left:(t.selectArea.x<t.selectArea.rx?t.selectArea.x:t.selectArea.rx)+"px",width:Math.abs(t.selectArea.rx-t.selectArea.x)+"px",height:Math.abs(t.selectArea.by-t.selectArea.y)+"px"}})},staticRenderFns:[]};var le=n("VU/8")({name:"selectArea",data:function(){return{}},created:function(){},computed:{selectArea:function(){return this.storeState.selectArea}}},ce,!1,function(t){n("sX1U")},"data-v-52d6e54b",null).exports,ue=!1,de=!1,he=function(t){clearTimeout(de),this.compHover=!0,t.stopPropagation()},me=function(t){var e=this;de=setTimeout(function(){e.compHover=!1},600)},ve=function(t){var e=this.storeState.activeModule;ue=!0,"Control"===this.$editor.container.keydowns&&e?e instanceof Array?this.$store.commit("activeModule",e.concat([this.moduleName])):this.$store.commit("activeModule",[e,this.moduleName]):this.$store.commit("activeModule",this.moduleName),this.compHover=!0},fe=function(t){this.$store.commit("visibleContextmenu",{x:t.pageX-this.$editor.containerOffset.x,y:t.pageY-this.$editor.containerOffset.y,componentName:this.moduleName,show:!0}),event.preventDefault(),event.stopPropagation()},pe={data:function(){return{compHover:!1}},computed:{showMenu:function(){return this.$store.state.activeModule===this.moduleName||!this.$store.state.activeModule&&this.compHover}},mounted:function(){var t=this;this.$store.commit("activeModule",this.moduleName),this.$el.addEventListener("mouseenter",he.bind(this),!1),this.$el.addEventListener("mouseleave",me.bind(this),!1),this.$el.addEventListener("mousedown",ve.bind(this),!1),this.$el.addEventListener("contextmenu",fe.bind(this),!1);var e=!0;this.$editor.listenser.once({name:"mouseup.mounted",callback:function(n){e&&t.$store.commit("activeModule",t.moduleName)}}),this.$editor.listenser.on({name:"mousedown."+this.moduleName,callback:function(n){e=!1,ue||(ue=!1,t.$store.commit("activeModule",null))}}),this.$editor.listenser.on({name:"mouseup."+this.moduleName,callback:function(t){ue=!1}})},beforeDestroy:function(){this.$editor.listenser.remove("mousedown."+this.moduleName),this.$el.removeEventListener("mouseenter",he),this.$el.removeEventListener("mouseleave",me),this.$el.removeEventListener("mouseup."+this.moduleName,ve),this.$el.removeEventListener("mousedown",ve),this.$el.removeEventListener("contextmenu",fe)}},ge=(n("D9hl"),{name:"coustom",components:{compMenu:Jt},mixins:[pe],props:["state","moduleName"],data:function(){return{}},computed:{title:function(){return this.state.textEditorContent},iconList:function(t,e){return this.state.selectedIcons}},methods:{setting:function(){this.$store.commit("toggleIconsSettingVisible",!0)},showTextEditor:function(){this.$store.commit("toggleEditorVisible",!0)}}}),xe={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"component-coustom"},[e("comp-menu",{directives:[{name:"show",rawName:"v-show",value:this.showMenu,expression:"showMenu"}],attrs:{menuItems:"del"}}),this._v(" "),e("div",{staticClass:"inner"},[e("div",{staticClass:"title ql-editor",attrs:{title:"双击设置标题"},domProps:{innerHTML:this._s(this.title||"双击设置标题")},on:{dblclick:this.showTextEditor}})])],1)},staticRenderFns:[]};var we=n("VU/8")(ge,xe,!1,function(t){n("/dKF")},"data-v-76b81c4a",null).exports,ye=n("aiqZ"),ke=(n("lMgl"),[["bold","italic","underline","strike"],[{color:[]},{background:[]}]]),be={name:"textEditor",components:{quillEditor:ye.quillEditor},data:function(){return{content:this.value,editorOption:{theme:"snow",placeholder:"请输入文字",modules:{toolbar:{container:ke}}}}},watch:{visible:function(t){t&&(this.content=this.getSingleActiveModule("textEditorContent"))}},computed:{visible:{get:function(){return this.storeState.textEditorVisible},set:function(t){this.$store.commit("toggleEditorVisible",t)}}},methods:{limitLength:function(t){t.text&&(this.text=t.text.trim())},saveText:function(){this.text?this.text.length>10?this.$message.error("标题字数不得超过10个！"):(this.visible=!1,function(t,e,n){Bt.commit(t+"/"+e,n)}(this.activeModuleName,"saveTextEditor",this.content)):this.$message.error("请输入标题！")}}},Ce={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{on:{mousedown:function(t){t.stopPropagation()}}},[n("el-dialog",{staticClass:"wall",attrs:{title:"编辑标题",visible:t.visible,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(e){t.visible=e}}},[n("quill-editor",{ref:"myQuillEditor",staticClass:"editor",attrs:{options:t.editorOption},on:{change:t.limitLength},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),n("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticStyle:{width:"240px"},attrs:{type:"primary"},on:{click:t.saveText}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var _e={name:"Aside",components:{compMenu:Jt,crossline:ne,axis:ie,contextmenu:ae,menuAxis:H,selectArea:le,compOuter:te,coustom:we,textEditor:n("VU/8")(be,Ce,!1,function(t){n("90Dm")},null,null).exports},computed:{containerStyle:function(){var t=this.storeState,e=t.resolution&&t.resolution.split("*"),n={};return e&&(n.width=e[0]+"px",n.height=e[1]+"px"),n}},methods:{isModule:function(t){return 0===t.indexOf("module-")},compStyle:function(t){return{left:t.x+"px",top:t.y+"px",zIndex:t.zIndex,width:t.width+"px",height:t.height+"px"}},isActive:function(t){var e=this.activeModuleName;return e===t||Array.isArray(e)&&e.indexOf(t)>=0}}},Me={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:t.containerStyle,attrs:{id:"main"}},[t._l(t.storeState,function(e,o){return t.isModule(o)?n("div",{directives:[{name:"drag",rawName:"v-drag",value:o,expression:"name"}],key:o,staticClass:"component",class:{active:t.isActive(o)},style:t.compStyle(e)},[n(o&&o.split("-")[1],{tag:"component",attrs:{state:e,"module-name":o}})],1):t._e()}),t._v(" "),n("comp-outer"),t._v(" "),n("crossline"),t._v(" "),n("axis"),t._v(" "),n("contextmenu"),t._v(" "),n("select-area"),t._v(" "),n("text-editor")],2)},staticRenderFns:[]};var $e={name:"layout",components:{Aside:f,Main:n("VU/8")(_e,Me,!1,function(t){n("fCqH")},"data-v-bf6561ca",null).exports,Header:mt},data:function(){return{height:"100%",width:"100%"}},mounted:function(){var t=this,e=this.$store.history;this.resize(),window.addEventListener("resize",function(){(function(t,e){var n=this;l&&clearTimeout(l),l=setTimeout(function(){t.bind(n)()},e||300)}).bind(t)(t.resize)}),window.addEventListener("beforeunload",function(e){if(t.isModify()){var n="确定离开当前页面吗？未保存的内容或将丢失！";return(window.event||e).returnValue=n,n}}),e.update(),u("lastModify",s()(e.getCurdo()))},methods:{resize:function(){this.width=document.body.clientWidth,this.height=document.body.clientHeight},isModify:function(){return d("lastModify")!==s()(this.$store.history.getCurdo())}}},Ae={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-container",{staticClass:"is-vertical"},[e("Header"),this._v(" "),e("el-container",{style:{height:this.height+"px"}},[e("Aside"),this._v(" "),e("el-main",{style:{width:this.width-100+"px"}},[e("Main")],1)],1)],1)},staticRenderFns:[]};var Se={components:{layout:n("VU/8")($e,Ae,!1,function(t){n("NCQU")},"data-v-6aeaf886",null).exports},name:"App"},Ee={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("layout")],1)},staticRenderFns:[]};var Ne=n("VU/8")(Se,Ee,!1,function(t){n("7FVV")},null,null).exports,Te=n("rflr"),Ie=n.n(Te),Le=(n("zMOa"),n("Gu7T")),Ue=n.n(Le),Pe=function(){var t=this,e=0,n=function(t,e,n){return n.hasOwnProperty(t)&&t===e},o=function(t,o,i){var s=t.split(".")[0],r=t.split(".")[1];for(var a in e=0,o)if(n(a,s,o)){var c=o[a];for(e=0;e<c.length;e++){var l=c[e];r&&r!==l.namespace||i(l,e,c)}}},i={events:{},on:function(t){var e=t.name.split(".")[0],n=t.name.split(".")[1];n&&(t.namespace=n),this.events[e]?this.events[e].push(t):this.events[e]=[t]},once:function(t){t.once=!0,this.on(t)},fire:function(n){for(var i=arguments.length,s=Array(i>1?i-1:0),r=1;r<i;r++)s[r-1]=arguments[r];o(n,this.events,function(n,o,i){n.callback.bind(t).apply(void 0,Ue()(s)),n.once&&(i.splice(o,1),e--)})},remove:function(t){o(t,this.events,function(t,n,o){o.splice(n,1),e--})}};this.listenser=i},Re=function(){var t=void 0;if(t="string"==typeof this.selector?document.getElementById(this.selector):this.selector,!t)throw new Error("Invalid selector: "+this.selector);t.className=t.className+" desk-editor",this.container=t,this.containerWraper=t.parentNode,this.containerOffset={x:this.container.getBoundingClientRect().left,y:this.container.getBoundingClientRect().top}},Fe=function(){var t=this.container,e=this.containerWraper,n=this.listenser,o=this.containerOffset,i=this.store,s=!1,r=void 0,a=void 0,c=void 0,l=void 0;t.addEventListener("mousedown",function(t){var c=t.pageX+e.scrollLeft-o.x,l=t.pageY+e.scrollTop-o.y;n.fire("mousedown",{moveX:c,moveY:l}),i.state.activeModule||(s=!0,r=c,a=l)}),document.addEventListener("mousemove",function(t){var u=t.pageX+e.scrollLeft-o.x,d=t.pageY+e.scrollTop-o.y;n.fire("mousemove",{moveX:u,moveY:d}),s&&(c=u,l=d,i.state.selectArea={show:!0,x:r,y:a,rx:c,by:l},function(){var t,e=[];for(var n in i.state){var o=i.state[n];It(n)&&(t=o).x>r&&t.y>a&&t.x+t.width<c&&t.y+t.height<l&&e.push(n)}1===e.length?i.state.activeModule=e[0]:e.length>1&&(i.state.activeModule=e)}())}),document.addEventListener("mouseup",function(t){var r=t.pageX+e.scrollLeft-o.x,a=t.pageY+e.scrollTop-o.y;!0===s&&(s=!1,i.state.selectArea={show:!1,x:0,y:0,rx:0,by:0}),n.fire("mouseup",{moveX:r,moveY:a})}),document.addEventListener("webkitfullscreenchange",function(t){document.webkitIsFullScreen?n.fire("entryfullScreen",{}):n.fire("exitFullScreen",{})})},Ve=function(){var t=this.store,e=this.container,n=this.containerWraper,o=this.containerOffset;e.oncontextmenu=function(e){t.commit("visibleContextmenu",{x:e.pageX+n.scrollLeft-o.x,y:e.pageY+n.scrollTop-o.y,componentName:"",show:!0}),e.preventDefault(),e.stopPropagation()},document.addEventListener("mousedown",function(e){t.commit("visibleContextmenu",{show:!1})})},De=void 0,ze=[],Be=null,Oe=void 0,He=void 0,Xe=function(t,e,n,o){var i=!1,s=De.state,r=this.listenser,c=s.activeModule,l=this.containerOffset;"string"==typeof c&&(c=[c]);var u=[],d=!0,h=!1,m=void 0;try{for(var v,f=a()(c);!(d=(v=f.next()).done);d=!0){var p=v.value;u.push({x:t-l.x-s[p].x,y:e-l.y-s[p].y})}}catch(t){h=!0,m=t}finally{try{!d&&f.return&&f.return()}finally{if(h)throw m}}!function(t,e){for(var n in ze=[],t)if((!Array.isArray(e)&&n!==e||Array.isArray(e)&&-1===e.indexOf(n))&&It(n)){var o=t[n];ze.push({x:o.x,y:o.y,cx:o.x+o.width/2,cy:o.y+o.height/2,rx:o.x+o.width,by:o.y+o.height})}}(s,c),r.on({name:"mousemove.drag",callback:function(t){i=!0;for(var e,r,l,d,h=void 0,m=(e=void 0,r=void 0,l=void 0,d=void 0,function(t,n,o){return(void 0===e||e>n)&&(e=n),(void 0===r||r>o)&&(r=o),(void 0===l||n+t.width>l)&&(l=n+t.width),(void 0===d||o+t.width>d)&&(d=o+t.height),{x:e,y:r,rx:l,by:d}}),v=function(e){var i=c[e],r=t.moveX-u[e].x,a=t.moveY-u[e].y;h=m(s[i],r,a);var l={name:i,x:r,y:a};if(s[i].locked)return"continue";l.x<0&&(l.x=0),l.y<0&&(l.y=0),l.y+s[i].height>n&&(l.y=n-s[i].height),l.x+s[i].width>o&&(l.x=o-s[i].width),setTimeout(function(){He&&(l.y=l.y+He),Oe&&(l.x=l.x+Oe),De.commit("updatePos",l)},0)},f=0;f<c.length;f++)v(f);h.cx=h.x+(h.rx-h.x)/2,h.cy=h.y+(h.by-h.y)/2,function(t,e,n,o,i,s,r){if(ze.length){var c=void 0,l=void 0,u=0,d=0,h=[o,e,s],m=[i,n,r],v=!0,f=!1,p=void 0;try{t:for(var g,x=a()(ze);!(v=(g=x.next()).done);v=!0){var w=g.value,y=!0,k=!1,b=void 0;try{for(var C,_=a()(h);!(y=(C=_.next()).done);y=!0)for(var M=C.value,$=["cx","x","rx"],A=0;A<$.length;A++){var S=$[A];if(Math.abs(w[S]-M)<5){c=w[S],u=w[S]-M;break t}}}catch(t){k=!0,b=t}finally{try{!y&&_.return&&_.return()}finally{if(k)throw b}}var E=!0,N=!1,T=void 0;try{for(var I,L=a()(m);!(E=(I=L.next()).done);E=!0)for(var U=I.value,P=["cy","y","by"],R=0;R<P.length;R++){var F=P[R];if(Math.abs(w[F]-U)<5){l=w[F],d=w[F]-U;break t}}}catch(t){N=!0,T=t}finally{try{!E&&L.return&&L.return()}finally{if(N)throw T}}}}catch(t){f=!0,p=t}finally{try{!v&&x.return&&x.return()}finally{if(f)throw p}}u&&(Oe=u||0),d&&(He=d||0),clearTimeout(Be),Be=setTimeout(function(){t.crossline.y=c||-1,t.crossline.x=l||-1},10)}}(s,h.x,h.y,h.cx,h.cy,h.rx,h.by)}}),r.once({name:"mouseup.drag",callback:function(t){r.remove("mousemove.drag"),function(t){clearTimeout(Be),Be=setTimeout(function(){t.crossline.y=-1,t.crossline.x=-1},10)}(s),i&&(De.history.update(),i=!1)}})},Ye=function(){return De=this.store,this.drag=Xe,Xe},je=function(){var t=this.listenser,e=this.container;window.addEventListener("keydown",function(n){var o=n.keyCode;o===b("Control")&&(e.keydowns="Control"),t.fire("keydown",o,n)}),window.addEventListener("keyup",function(n){var o=n.keyCode;o===b("Delete")&&Wt(),o===b("Control")&&(e.keydowns=""),t.fire("keyup",o,n)})},qe=[Pe,Re,Fe,Ye,Ve,je],We={install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=gt()(null);n.selector=e.selector,n.store=e.store,qe.forEach(function(t){t.bind(n)()}),window.editor=t.prototype.$editor=n},listenser:Pe,container:Re,events:Fe,drag:Ye,keyboard:je,contextmenu:Ve},Ge=[{name:"pick",bind:function(t,e,n){t.addEventListener("mousedown",function(){if("forbid"!==e.value){var t=n.context.$editor,o=n.context.$store,i=t.listenser,s=!1,r=void 0,a=e.value,c=void 0;i.on({name:"mousemove.pick",callback:function(t){if(t.moveX>0&&!s)s=!0,c=qt(a,t);else{var e=o.state[c];e&&e.width&&(r={name:c,x:t.moveX-e.width/2,y:t.moveY-e.height/2},o.commit("updatePos",r))}}}),i.once({name:"mouseup.pick",callback:function(){if(s=!1,i.remove("mousemove.pick"),c){var e=t.container.getBoundingClientRect(),n=o.state[c],a=e.height-40,l=e.width-362;r&&(r.x<0||r.y<0||r.x+n.width>l||r.y+n.height>a)?setTimeout(function(){Wt(c)},0):o.history.update()}}})}},!1)}},{name:"drag",bind:function(t,e,n){var o=n.context;t.addEventListener("mousedown",function(t){var n=o.$editor.containerWraper,i=t.pageX+n.scrollLeft,s=t.pageY+n.scrollTop,r=o.$editor.container.getBoundingClientRect().height,a=o.$editor.container.getBoundingClientRect().width;o.$editor.drag(i,s,r,a),e.modifiers.stop&&t.stopPropagation()})}}],Qe=function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];Ge.forEach(function(e){t.directive(e.name,e)})},Je=function(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.mixin({computed:{storeState:function(){return this.$store.state},activeModuleName:function(){return this.$store.state.activeModule}},methods:{deepClone:function(t){try{return JSON.parse(s()(t))}catch(t){}return null},iteratorModule:function(t){return Lt(this.storeState,t)},iteratorActiveModule:function(t,e){return Ut(this.storeState,t,e)},activeUnlockModule:function(){return Pt(this.storeState)},getSingleActiveModule:function(t){return Rt(this.storeState,t)}}})};n("r6k1").polyfill(),o.default.config.productionTip=!1,o.default.use(Ie.a),o.default.use(Qe),o.default.use(Je),new o.default({el:"#app",store:Bt,components:{App:Ne},template:"<App/>",mounted:function(){o.default.use(We,{selector:"main",store:Bt})}})},PSQn:function(t,e){},QG2y:function(t,e){},U0M3:function(t,e){},UqU4:function(t,e){},aAE9:function(t,e){},anDC:function(t,e){},eQ82:function(t,e){},fCqH:function(t,e){},hlQI:function(t,e){},"jF/t":function(t,e){},jZJS:function(t,e){},lMgl:function(t,e){},sX1U:function(t,e){},w8ly:function(t,e){},zMOa:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.55a1fc8ea5690001dab4.js.map